{"ast":null,"code":"var _jsxFileName = \"/Users/jackieennis/Coding/ClimateCabinet/accountability-map/src/App.js\";\nimport React, { useRef, useEffect } from 'react';\nimport './App.css';\nimport mapboxgl from 'mapbox-gl';\nimport \"mapbox-gl/dist/mapbox-gl.css\";\nimport \"mapbox-gl/dist/mapbox-gl.js\";\nimport Places from 'places.js';\nimport rd3 from 'react-d3-library'; // mapbox access token from mapbox.com\n\nmapboxgl.accessToken = process.env.REACT_APP_MAPBOX_TOKEN; // variable to define the zoom lvl of when to go from county view to tract view\n\nconst zoomThreshold = 9; // the map application\n\nfunction App() {\n  const mapboxElRef = useRef(null);\n  useEffect(() => {\n    const map = new mapboxgl.Map({\n      container: mapboxElRef.current,\n      style: \"mapbox://styles/mapbox/light-v10\",\n      // style of the basemap\n      // TODO: change the basemap style to only show county name and city name\n      center: [-99.514301, 31.616819],\n      // centers the view of the map\n      minZoom: 5,\n      // disables zooming out past zoom lvl 5\n      pitchWithRotate: false,\n      // disables rotating the map\n      dragRotate: false // disables rotating the map\n      // maxBounds: [[],[]] // view boundaries for the map\n\n    }); // adds geocoder\n    // });\n    // TODO: figure out how to add Algolia to query the map\n    // (https://community.algolia.com/places/examples.html?utm_medium=social-owned&utm_source=GitHub&utm_campaign=places%20repository)\n    // var placesAutocomplete = new Places({\n    //   appId: process.env.REACT_APP_APPID,\n    //   apiKey: process.env.REACT_APP_APIKEY,\n    //   container: document.querySelector('#input-map')\n    // });\n    //\n    // placesAutocomplete.on('change', e => console.log(e.suggestion))\n    // disables rotating the map\n\n    map.touchZoomRotate.disableRotation(); // adds zooming in and out buttoms\n    // map.addControl(new mapboxgl.NavigationControl());\n    // create variables\n\n    var hoveredStateId = null;\n    var nameDisplay = document.getElementById('name');\n    var scoreDisplay = document.getElementById('score'); // basemap and layers\n    // TODO: fetching the data from mongodb via node.js ??? \n    // TODO: connect w GraphQL API and show ashtma rates at the national scale \n\n    map.on('load', function () {\n      // Adding data sources to the map\n      // source for the county data\n      map.addSource('countyjson', {\n        'type': 'geojson',\n        'data': 'https://raw.githubusercontent.com/shelbygreen/env-racism-map/master/county_population_score.json',\n        'generateId': true // TODO: fix highlight bug from generateId. should probably add id field\n        // to the json and make sure its within the properties\n\n      }); // source for the tract data\n\n      map.addSource('tractjson', {\n        'type': 'geojson',\n        'data': 'https://raw.githubusercontent.com/shelbygreen/env-racism-map/master/tract_population_score.json',\n        'generateId': true\n      }); // Adding layers to the map\n      // choropleth layer for the county data\n\n      map.addLayer({\n        'id': 'countyjson-fill',\n        'type': 'fill',\n        'source': 'countyjson',\n        'layout': {},\n        'maxzoom': zoomThreshold,\n        // switches to tract view at this zoom lvl\n        'paint': {\n          'fill-color': {\n            property: 'score',\n            // colors coded by the 'score' attribute\n            stops: [[1, \"rgb(253,231,37)\"], [2, \"rgb(180,222,44)\"], [3, \"rgb(109,205,89)\"], [4, \"rgb(53,183,121)\"], [5, \"rgb(31,158,137)\"], [6, \"rgb(38,130,142)\"], [7, \"rgb(49,104,142)\"], [8, \"rgb(62,74,137)\"], [9, \"rgb(72,40,120)\"], [10, \"rgb(68,1,84)\"]]\n          },\n          'fill-opacity': ['case', ['boolean', ['feature-state', 'hover'], false], 0.7, 0.7]\n        }\n      }, 'waterway-label'); // choropleth layer for the tract data\n\n      map.addLayer({\n        'id': 'tractjson-fill',\n        'type': 'fill',\n        'source': 'tractjson',\n        'layout': {},\n        'minzoom': zoomThreshold,\n        'paint': {\n          'fill-color': {\n            property: 'score',\n            stops: [[1, \"rgb(253,231,37)\"], [2, \"rgb(180,222,44)\"], [3, \"rgb(109,205,89)\"], [4, \"rgb(53,183,121)\"], [5, \"rgb(31,158,137)\"], [6, \"rgb(38,130,142)\"], [7, \"rgb(49,104,142)\"], [8, \"rgb(62,74,137)\"], [9, \"rgb(72,40,120)\"], [10, \"rgb(68,1,84)\"]]\n          },\n          'fill-opacity': ['case', ['boolean', ['feature-state', 'hover'], false], 0.7, 0.7]\n        }\n      }, 'waterway-label'); // highlight layer for the county data - adds thick white border to county\n\n      map.addLayer({\n        'id': 'countyjson-highlight',\n        'type': 'line',\n        'source': 'countyjson',\n        'layout': {},\n        'maxzoom': zoomThreshold,\n        'paint': {\n          'line-width': ['case', ['boolean', ['feature-state', 'hover'], false], 3, 0.4],\n          'line-color': \"#FFFFFF\"\n        }\n      }, 'waterway-label'); // highlight layer for the tract data - adds thick white border to tract\n\n      map.addLayer({\n        'id': 'tractjson-highlight',\n        'type': 'line',\n        'source': 'tractjson',\n        'layout': {},\n        'minzoom': zoomThreshold,\n        'paint': {\n          'line-width': ['case', ['boolean', ['feature-state', 'hover'], false], 3, 0.5],\n          'line-color': \"#FFFFFF\"\n        }\n      }, 'waterway-label');\n    }); // Populating sidebar and highlight on hover feature\n    // TODO: add city to tract title\n\n    map.on('mousemove', 'countyjson-fill', function (e) {\n      // change the pointer style when on a region\n      map.getCanvas().style.cursor = 'pointer'; // set variables equal to the current feature's details\n\n      var regionName = e.features[0].properties.name;\n      var regionScore = e.features[0].properties.score;\n\n      if (e.features) {\n        // if the feature exists, populate the sidebar\n        nameDisplay.textContent = regionName;\n        scoreDisplay.textContent = regionScore; // add a highlight\n\n        if (hoveredStateId) {\n          map.setFeatureState({\n            source: 'countyjson',\n            id: hoveredStateId\n          }, {\n            hover: false\n          });\n        }\n\n        hoveredStateId = e.features[0].id;\n        map.setFeatureState({\n          source: 'countyjson',\n          id: hoveredStateId\n        }, {\n          hover: true\n        });\n      }\n    });\n    map.on('mousemove', 'tractjson-fill', function (e) {\n      // change the pointer style when on a region\n      map.getCanvas().style.cursor = 'pointer'; // set variables equal to the current feature's details\n\n      var regionName = e.features[0].properties.name;\n      var regionScore = e.features[0].properties.score;\n\n      if (e.features) {\n        // if the feature exists, populate the sidebar\n        nameDisplay.textContent = regionName;\n        scoreDisplay.textContent = regionScore; // add a highlight\n\n        if (hoveredStateId) {\n          map.setFeatureState({\n            source: 'tractjson',\n            id: hoveredStateId\n          }, {\n            hover: false\n          });\n        }\n\n        hoveredStateId = e.features[0].id;\n        map.setFeatureState({\n          source: 'tractjson',\n          id: hoveredStateId\n        }, {\n          hover: true\n        });\n      }\n    });\n    map.on('mouseleave', 'countyjson-fill', function () {\n      // change the pointer style\n      map.getCanvas().style.cursor = 'default'; // Remove the information from the previously hovered feature from the sidebar\n      // nameDisplay.textContent = '';\n      // scoreDisplay.textContent = '';\n\n      if (hoveredStateId) {\n        map.setFeatureState({\n          source: 'countyjson',\n          id: hoveredStateId\n        }, {\n          hover: false\n        });\n      }\n\n      hoveredStateId = null;\n    });\n    map.on('mouseleave', 'tractjson-fill', function () {\n      map.getCanvas().style.cursor = 'default'; // Remove the information from the previously hovered feature from the sidebar\n\n      nameDisplay.textContent = 'Select a region for details';\n      scoreDisplay.textContent = '';\n\n      if (hoveredStateId) {\n        map.setFeatureState({\n          source: 'tractjson',\n          id: hoveredStateId\n        }, {\n          hover: false\n        });\n      }\n\n      hoveredStateId = null;\n    }); // load initial data for the sidebar\n\n    map.onLoad = document.getElementById(\"name\").innerHTML = \"Select a region to see details\";\n  });\n  return /*#__PURE__*/React.createElement(\"div\", {\n    class: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"navbar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"main\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    ref: mapboxElRef,\n    id: \"mapContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"side\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"ui left fixed vertical menu\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"name\",\n    id: \"name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    class: \"score\",\n    id: \"score\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 15\n    }\n  })))));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/jackieennis/Coding/ClimateCabinet/accountability-map/src/App.js"],"names":["React","useRef","useEffect","mapboxgl","Places","rd3","accessToken","process","env","REACT_APP_MAPBOX_TOKEN","zoomThreshold","App","mapboxElRef","map","Map","container","current","style","center","minZoom","pitchWithRotate","dragRotate","touchZoomRotate","disableRotation","hoveredStateId","nameDisplay","document","getElementById","scoreDisplay","on","addSource","addLayer","property","stops","e","getCanvas","cursor","regionName","features","properties","name","regionScore","score","textContent","setFeatureState","source","id","hover","onLoad","innerHTML"],"mappings":"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","sourcesContent":["import React, {useRef, useEffect} from 'react';\nimport './App.css';\nimport mapboxgl from 'mapbox-gl';\nimport \"mapbox-gl/dist/mapbox-gl.css\";\nimport \"mapbox-gl/dist/mapbox-gl.js\";\nimport Places from 'places.js';\nimport rd3 from 'react-d3-library'\n\n\n// mapbox access token from mapbox.com\nmapboxgl.accessToken = process.env.REACT_APP_MAPBOX_TOKEN;\n\n// variable to define the zoom lvl of when to go from county view to tract view\nconst zoomThreshold = 9;\n\n// the map application\nfunction App() {\n  const mapboxElRef = useRef(null);\n\n  useEffect(() => {\n    const map = new mapboxgl.Map({\n      container: mapboxElRef.current,\n      style: \"mapbox://styles/mapbox/light-v10\", // style of the basemap\n      // TODO: change the basemap style to only show county name and city name\n      center: [-99.514301, 31.616819], // centers the view of the map\n      minZoom: 5, // disables zooming out past zoom lvl 5\n      pitchWithRotate: false, // disables rotating the map\n      dragRotate: false // disables rotating the map\n      // maxBounds: [[],[]] // view boundaries for the map\n    });\n\n    // adds geocoder\n    // });\n    // TODO: figure out how to add Algolia to query the map\n    // (https://community.algolia.com/places/examples.html?utm_medium=social-owned&utm_source=GitHub&utm_campaign=places%20repository)\n    // var placesAutocomplete = new Places({\n    //   appId: process.env.REACT_APP_APPID,\n    //   apiKey: process.env.REACT_APP_APIKEY,\n    //   container: document.querySelector('#input-map')\n    // });\n    //\n    // placesAutocomplete.on('change', e => console.log(e.suggestion))\n\n    // disables rotating the map\n    map.touchZoomRotate.disableRotation();\n\n    // adds zooming in and out buttoms\n    // map.addControl(new mapboxgl.NavigationControl());\n\n    // create variables\n    var hoveredStateId = null;\n    var nameDisplay = document.getElementById('name');\n    var scoreDisplay = document.getElementById('score');\n\n    // basemap and layers\n\n    // TODO: fetching the data from mongodb via node.js ??? \n    // TODO: connect w GraphQL API and show ashtma rates at the national scale \n    map.on('load', function() {\n      // Adding data sources to the map\n      // source for the county data\n      map.addSource('countyjson', {\n        'type': 'geojson',\n        'data': 'https://raw.githubusercontent.com/shelbygreen/env-racism-map/master/county_population_score.json',\n        'generateId': true\n        // TODO: fix highlight bug from generateId. should probably add id field\n        // to the json and make sure its within the properties\n      });\n\n      // source for the tract data\n      map.addSource('tractjson', {\n        'type': 'geojson',\n        'data': 'https://raw.githubusercontent.com/shelbygreen/env-racism-map/master/tract_population_score.json',\n        'generateId': true\n      });\n\n      // Adding layers to the map\n      // choropleth layer for the county data\n      map.addLayer({\n        'id': 'countyjson-fill',\n        'type': 'fill',\n        'source': 'countyjson',\n        'layout': {},\n        'maxzoom': zoomThreshold, // switches to tract view at this zoom lvl\n        'paint': {\n          'fill-color': {\n            property: 'score', // colors coded by the 'score' attribute\n            stops: [\n              [1, \"rgb(253,231,37)\"],\n              [2, \"rgb(180,222,44)\"],\n              [3, \"rgb(109,205,89)\"],\n              [4, \"rgb(53,183,121)\"],\n              [5, \"rgb(31,158,137)\"],\n              [6, \"rgb(38,130,142)\"],\n              [7, \"rgb(49,104,142)\"],\n              [8, \"rgb(62,74,137)\"],\n              [9, \"rgb(72,40,120)\"],\n              [10, \"rgb(68,1,84)\"]\n            ]\n          },\n          'fill-opacity': [\n            'case',\n            ['boolean', ['feature-state', 'hover'], false],\n            0.7,\n            0.7\n          ]\n        },\n      }, 'waterway-label');\n\n      // choropleth layer for the tract data\n      map.addLayer({\n        'id': 'tractjson-fill',\n        'type': 'fill',\n        'source': 'tractjson',\n        'layout': {},\n        'minzoom': zoomThreshold,\n        'paint': {\n          'fill-color': {\n            property: 'score',\n            stops: [\n              [1, \"rgb(253,231,37)\"],\n              [2, \"rgb(180,222,44)\"],\n              [3, \"rgb(109,205,89)\"],\n              [4, \"rgb(53,183,121)\"],\n              [5, \"rgb(31,158,137)\"],\n              [6, \"rgb(38,130,142)\"],\n              [7, \"rgb(49,104,142)\"],\n              [8, \"rgb(62,74,137)\"],\n              [9, \"rgb(72,40,120)\"],\n              [10, \"rgb(68,1,84)\"]\n            ]\n          },\n            'fill-opacity': [\n              'case',\n              ['boolean', ['feature-state', 'hover'], false],\n              0.7,\n              0.7\n            ]\n        }\n      }, 'waterway-label');\n\n      // highlight layer for the county data - adds thick white border to county\n      map.addLayer({\n        'id': 'countyjson-highlight',\n        'type': 'line',\n        'source': 'countyjson',\n        'layout': {},\n        'maxzoom': zoomThreshold,\n        'paint': {\n          'line-width': [\n            'case',\n            ['boolean', ['feature-state', 'hover'], false],\n            3,\n            0.4\n          ],\n          'line-color': \"#FFFFFF\"\n        }\n      }, 'waterway-label');\n\n      // highlight layer for the tract data - adds thick white border to tract\n      map.addLayer({\n        'id': 'tractjson-highlight',\n        'type': 'line',\n        'source': 'tractjson',\n        'layout': {},\n        'minzoom': zoomThreshold,\n        'paint': {\n          'line-width': [\n            'case',\n            ['boolean', ['feature-state', 'hover'], false],\n            3,\n            0.5\n          ],\n          'line-color': \"#FFFFFF\"\n        }\n      }, 'waterway-label');\n\n    });\n\n    // Populating sidebar and highlight on hover feature\n    // TODO: add city to tract title\n    map.on('mousemove', 'countyjson-fill', function(e) {\n      // change the pointer style when on a region\n      map.getCanvas().style.cursor = 'pointer';\n\n      // set variables equal to the current feature's details\n      var regionName = e.features[0].properties.name;\n      var regionScore = e.features[0].properties.score;\n\n      if (e.features) {\n        // if the feature exists, populate the sidebar\n        nameDisplay.textContent = regionName;\n        scoreDisplay.textContent = regionScore;\n\n        // add a highlight\n        if (hoveredStateId) {\n          map.setFeatureState({\n            source: 'countyjson',\n            id: hoveredStateId\n          }, {\n            hover: false\n          });\n        }\n\n        hoveredStateId = e.features[0].id;\n\n        map.setFeatureState({\n          source: 'countyjson',\n          id: hoveredStateId\n        },{\n          hover: true\n        });\n\n      }\n    });\n\n    map.on('mousemove', 'tractjson-fill', function(e) {\n      // change the pointer style when on a region\n      map.getCanvas().style.cursor = 'pointer';\n\n      // set variables equal to the current feature's details\n      var regionName = e.features[0].properties.name;\n      var regionScore = e.features[0].properties.score;\n\n      if (e.features) {\n        // if the feature exists, populate the sidebar\n        nameDisplay.textContent = regionName;\n        scoreDisplay.textContent = regionScore;\n\n        // add a highlight\n        if (hoveredStateId) {\n          map.setFeatureState({\n            source: 'tractjson',\n            id: hoveredStateId\n          }, {\n            hover: false\n          });\n        }\n\n        hoveredStateId = e.features[0].id;\n\n        map.setFeatureState({\n          source: 'tractjson',\n          id: hoveredStateId\n        },{\n          hover: true\n        });\n\n      }\n    });\n\n    map.on('mouseleave', 'countyjson-fill', function () {\n      // change the pointer style\n      map.getCanvas().style.cursor = 'default';\n\n      // Remove the information from the previously hovered feature from the sidebar\n      // nameDisplay.textContent = '';\n      // scoreDisplay.textContent = '';\n\n      if (hoveredStateId) {\n        map.setFeatureState({\n          source: 'countyjson',\n          id: hoveredStateId\n        }, {\n          hover: false\n        });\n      }\n      hoveredStateId = null;\n    });\n\n    map.on('mouseleave', 'tractjson-fill', function () {\n      map.getCanvas().style.cursor = 'default';\n\n      // Remove the information from the previously hovered feature from the sidebar\n      nameDisplay.textContent = 'Select a region for details';\n      scoreDisplay.textContent = '';\n\n      if (hoveredStateId) {\n        map.setFeatureState({\n          source: 'tractjson',\n          id: hoveredStateId\n        }, {\n          hover: false\n        });\n      }\n      hoveredStateId = null;\n    });\n\n    // load initial data for the sidebar\n    map.onLoad = document.getElementById(\"name\").innerHTML = \"Select a region to see details\";\n\n});\n\n  return (\n    <div class=\"App\">\n      <div id=\"navbar\"></div>\n      <main>\n        <div\n          ref={mapboxElRef}\n          id=\"mapContainer\"></div>\n\n        <div id=\"side\">\n          <div class=\"ui left fixed vertical menu\">\n              <div class=\"name\" id=\"name\"></div>\n              <h2 class=\"score\" id=\"score\"></h2>\n          </div>\n        </div>\n      </main>\n  </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}